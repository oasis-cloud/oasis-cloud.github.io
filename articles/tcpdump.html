<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>tcpdump</title>
        <link rel="stylesheet" href="../assets/fonts.css">
        <link rel="stylesheet" href="../assets/graphite.css">
        <link rel="stylesheet" href="../assets/pygments.css">
        
        
    </head>
    <body class="node-articles--tcpdump node-articles- node-articles node">
        <header class="masthead">
            <h1><a href="../index.html">Oasis's Cloud</a></h1>
            
                <p class="tagline">â˜ï¸ğŸŒµï¸â˜ï¸ğŸŒµï¸â˜ï¸ğŸŒµâ˜ï¸ğŸŒµï¸â˜ï¸ğŸŒµï¸â˜ï¸ğŸŒµâ˜ï¸ğŸŒµ</p>
            
            
            <nav class="menu">
                <input id="menu-check" type="checkbox"/>
                <label id="menu-label" for="menu-check" class="unselectable">
                    <span class="icon close-icon">âœ•</span>
                    <span class="icon open-icon">â˜°</span>
                    <span class="text">Menu</span>
                </label>
                <ul>
<li><a href="../index.html">é¦–é¡µ</a></li>
</ul>
            </nav>
        </header>
        <article class="main">
            <header class="title">
                <h1>tcpdump</h1>
                
                <hr>
            </header>
            <blockquote>
<p>åŸæ–‡åœ°å€ï¼šhttps://jvns.ca/blog/2016/03/16/tcpdump-is-amazing/</p>
</blockquote>
<h2>tcpdump æ˜¯ä»€ä¹ˆ</h2>
<p>tcpdump æ˜¯ä¸€ä¸ªç½‘ç»œæŠ“åŒ…å·¥å…·ï¼Œé€šè¿‡ä½¿ç”¨å®ƒï¼Œå¯ä»¥æ•è·å’Œåˆ†æç½‘ç»œæ•°æ®åŒ…ã€‚å®ƒèƒ½å¤Ÿæ˜¾ç¤ºæºåœ°å€ã€ç›®æ ‡åœ°å€ã€åè®®ç±»å‹ã€ç«¯å£å·ã€æ•°æ®å†…å®¹ç­‰ä¿¡æ¯ã€‚è€Œä¸” tcpdump æ”¯æŒå¤šç§åè®®ï¼šTCPã€UDPã€ICMP ç­‰ã€‚å¹¶ä¸”æä¾›äº†ä¸°å¯Œçš„é€‰é¡¹å’Œè¿‡æ»¤è§„åˆ™ã€‚</p>
<h2>tcpdump å‘½ä»¤</h2>
<div class="highlight"><pre><span></span><code>NAME
       tcpdump - dump traffic on a network

SYNOPSIS
       tcpdump [ -AbdDefhHIJKlLnNOpqStuUvxX# ] [ -B buffer_size ]
               [ -c count ]
               [ -C file_size ] [ -G rotate_seconds ] [ -F file ]
               [ -i interface ] [ -j tstamp_type ] [ -k (metadata_arg) ]
               [ -m module ] [ -M secret ]
               [ --number ] [ -Q in|out|inout ]
               [ -r file ] [ -V file ] [ -s snaplen ] [ -T type ] [ -w file ]
               [ -W filecount ]
               [ -E spi@ipaddr algo:secret,...  ]
               [ -y datalinktype ] [ -z postrotate-command ] [ -Z user ]
               [ -Q packet-metadata-filter ] [ -Q in|out|inout ]
               [ --time-stamp-precision=tstamp_precision ]
               [ --immediate-mode ] [ --version ]
               [ expression ]
</code></pre></div>
<h2>tcpdump è¿”å›å†…å®¹è§£é‡Š</h2>
<p>å‘½ä»¤ ï¼š<code>sudo tcpdump -n -i any port 10086</code></p>
<p>tcpdump çš„è¿”å›å†…å®¹ä¾èµ–åè®®ã€‚ä¸‹é¢æ˜¯å¤§å¤šæ•°åè®®éƒ½æœ‰çš„éƒ¨åˆ†ã€‚</p>
<ul>
<li>æ—¶é—´æˆ³ï¼šæ˜¾ç¤ºæ•°æ®åŒ…æ•è·çš„æ—¶é—´å’Œæ—¥æœŸä¿¡æ¯ã€‚</li>
<li>æºåœ°å€å’Œç›®æ ‡åœ°å€ï¼šæŒ‡ç¤ºæ•°æ®åŒ…çš„æºIPåœ°å€å’Œç›®æ ‡IPåœ°å€ã€‚</li>
<li>åè®®ç±»å‹ï¼šæŒ‡ç¤ºæ•°æ®åŒ…ä½¿ç”¨çš„åè®®ï¼Œå¦‚TCPã€UDPã€ICMPç­‰ã€‚</li>
<li>æºç«¯å£å’Œç›®æ ‡ç«¯å£ï¼šæŒ‡ç¤ºæ•°æ®åŒ…çš„æºç«¯å£å’Œç›®æ ‡ç«¯å£å·ã€‚</li>
<li>æ•°æ®åŒ…é•¿åº¦ï¼šæŒ‡ç¤ºæ•°æ®åŒ…çš„é•¿åº¦ï¼Œé€šå¸¸ä»¥å­—èŠ‚ä¸ºå•ä½ã€‚</li>
<li>æ ‡å¿—å’Œæ§åˆ¶ä½ï¼šæŒ‡ç¤ºæ•°æ®åŒ…çš„æ ‡å¿—å’Œæ§åˆ¶ä½ï¼Œå¦‚TCPçš„SYNã€ACKã€FINç­‰ã€‚</li>
<li>æ•°æ®å†…å®¹ï¼šæ˜¾ç¤ºæ•°æ®åŒ…çš„åŸå§‹å†…å®¹ï¼Œå¦‚æ•°æ®åŒ…çš„æœ‰æ•ˆè½½è·æˆ–æœ‰æ•ˆè´Ÿè½½ã€‚</li>
</ul>
<p>è¯¦ç»†æ–‡æ¡£ï¼šhttps://www.tcpdump.org/manpages/tcpdump.1.html</p>
<p><code>15:34:37.823226 IP 201.31.11.117.10086 &gt; 201.31.11.117.50798: Flags [P.], seq 0:2, ack 1, win 6370, options [nop,nop,TS val 2670709546 ecr 3306380947], length 2</code></p>
<h2>ç½‘ç®¡å·¥å…·åŒ…</h2>
<ul>
<li>ping</li>
<li>dig/nslookup åŸŸåè§£æ</li>
<li>netstat/ss æ£€æµ‹ç«¯å£å·æ˜¯å¦å ç”¨</li>
<li>ifconfig æ£€æŸ¥ IP åœ°å€</li>
<li>ip é…ç½®è·¯ç”±</li>
<li>arp æŸ¥çœ‹ ARP Table</li>
<li>telnet æ£€æµ‹æœåŠ¡å™¨çš„ç«¯å£æ˜¯å¯ç”¨</li>
<li>ssh </li>
<li>lsof å“ªäº›ç«¯å£è¢«ä½¿ç”¨</li>
<li>sysctl é…ç½® socket</li>
<li>openvpn é…ç½® vpn</li>
<li>nftables/iptables é…ç½®é˜²ç«å¢™æˆ– NAT</li>
</ul>
        </article>
        
    </body>
</html>
